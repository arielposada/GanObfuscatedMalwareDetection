<h1 id="Obfuscated-Malware-Detection">Obfuscated Malware Detection</h1>
<p>Code associated to the paper: DEFENDIFY: Defense Amplified with Transfer Learning for Obfuscated Malware Framework</p>

<h1 id="QUICK-START-GUIDE">QUICK START GUIDE</h1>
<p>Before executing this project you have to consider the data flow of the solution, so you may decide what component(s) you desire to execute. In the data flow shown below we may identify different components which have the following functionality:</p>
<ol>
<li>Entropy tester : This classifier detects if a sample is or not obfuscated</li>
<li>Image Transformer : This module converts a sample to image</li>
<li>Not Encoded Classifier : This classfier is able to detect if a non encoded sample is Goodware or Malware</li>
<li>Shikata Ga Nai / XOR Classifier : This classifier is able to detect if a Shikata Ga Nai / XOR encoded sample is is Goodware or Malware</li>
</ol>
<p>You may decide to test each one of the modules that compose the flow or go directly to the deployed web application version.</p>

![Flow](misc/images_readme/flow.png)

## 1. Detecting obfuscation (Entropy Tester)

The python code to identify whether a binary file has been obfuscated (XOR/Shikata ga nai) can be found in the notebook `misc/entropy_tester/entropy_tester.ipynb`. In the cell named *Create and write entropy data*, the entropies for every file in the folders indicated by the user (in this case, the folders containing the samples from the previous section) are extracted and saved in a file named `entropies.csv`, which can be found in the `misc/entropy_tester` folder. Then, the cell named *Read entropy data* reads the CSV file. The remaining cells in the notebook test the performance of several machine learning algorithms when identifying obfuscated binary files based on its entropy.



## 2. Obtaining the images (Images Transformer)

The script `misc/binary2image.py` transforms executable files into greyscale images, as described in the paper. The script can be used with `python binary2image.py input_folder output_folder`, where `input_folder` contains the binary files and `output_folder` will contain the resulting images.

If you want to test by yourself the conversion from a goodware binary to images, you may use the python script binary2image.py, as shown in the image below, where is being applied over a folder that contains a a goodware file (zotero) in different versions: not obfuscated, XOR obfuscated and Shikata Ga Nai obfuscated

